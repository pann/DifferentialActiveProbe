<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 950 900">
  <defs>
    <style>
      .title { font: bold 14px sans-serif; fill: #333; }
      .subtitle { font: 11px sans-serif; fill: #666; }
      .axis-label { font: 9px sans-serif; fill: #333; }
      .legend { font: 9px sans-serif; fill: #333; }
      .grid { stroke: #ddd; stroke-width: 0.5; }
      .axis { stroke: #333; stroke-width: 1; }
      .step { font: 10px sans-serif; fill: #333; }
      .step-title { font: bold 11px sans-serif; fill: #0066cc; }
      .warning { font: bold 10px sans-serif; fill: #cc0000; }
      .note { font: italic 9px sans-serif; fill: #666; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="950" height="800" fill="#fafafa"/>

  <!-- Main Title -->
  <text x="475" y="25" text-anchor="middle" class="title" style="font-size:18px">Practical Tuning Guide for Differential Probe</text>

  <!-- TOP ROW: Three Step Response Examples -->
  <!-- UNDER-COMPENSATED -->
  <g transform="translate(30,45)">
    <rect x="0" y="0" width="280" height="180" fill="#ffeeee" stroke="#cc0000" rx="5"/>
    <text x="140" y="18" text-anchor="middle" class="title" fill="#cc0000">UNDER-COMPENSATED</text>
    <text x="140" y="32" text-anchor="middle" class="subtitle">(C1 too small)</text>

    <!-- Mini graph -->
    <rect x="20" y="45" width="160" height="100" fill="white" stroke="#ccc"/>
    <line x1="20" y1="145" x2="180" y2="145" class="axis"/>
    <line x1="20" y1="45" x2="20" y2="145" class="axis"/>

    <!-- Slow rising waveform -->
    <path d="M20,140 L30,140 Q50,140 70,120 Q100,80 140,72 L180,70"
          fill="none" stroke="#cc0000" stroke-width="2"/>
    <!-- Ideal reference -->
    <path d="M20,140 L30,140 L35,70 L180,70"
          fill="none" stroke="#999" stroke-width="1" stroke-dasharray="3,2"/>

    <text x="100" y="160" text-anchor="middle" class="axis-label">Time (ns)</text>

    <!-- Characteristics -->
    <text x="195" y="60" class="legend">• Rounded corner</text>
    <text x="195" y="75" class="legend">• Slow rise</text>
    <text x="195" y="90" class="legend">• No overshoot</text>
    <text x="195" y="115" class="legend" fill="#cc0000" style="font-weight:bold">→ Increase C1</text>
  </g>

  <!-- OPTIMAL -->
  <g transform="translate(335,45)">
    <rect x="0" y="0" width="280" height="180" fill="#eeffee" stroke="#00aa00" rx="5"/>
    <text x="140" y="18" text-anchor="middle" class="title" fill="#00aa00">OPTIMAL</text>
    <text x="140" y="32" text-anchor="middle" class="subtitle">(C1 correct)</text>

    <!-- Mini graph -->
    <rect x="20" y="45" width="160" height="100" fill="white" stroke="#ccc"/>
    <line x1="20" y1="145" x2="180" y2="145" class="axis"/>
    <line x1="20" y1="45" x2="20" y2="145" class="axis"/>

    <!-- Clean square response -->
    <path d="M20,140 L30,140 L35,70 L180,70"
          fill="none" stroke="#00aa00" stroke-width="2"/>

    <text x="100" y="160" text-anchor="middle" class="axis-label">Time (ns)</text>

    <!-- Characteristics -->
    <text x="195" y="60" class="legend">• Sharp corner</text>
    <text x="195" y="75" class="legend">• Fast rise</text>
    <text x="195" y="90" class="legend">• Flat top</text>
    <text x="195" y="115" class="legend" fill="#00aa00" style="font-weight:bold">= CORRECT</text>
  </g>

  <!-- OVER-COMPENSATED -->
  <g transform="translate(640,45)">
    <rect x="0" y="0" width="280" height="180" fill="#ffeeee" stroke="#cc0000" rx="5"/>
    <text x="140" y="18" text-anchor="middle" class="title" fill="#cc0000">OVER-COMPENSATED</text>
    <text x="140" y="32" text-anchor="middle" class="subtitle">(C1 too large)</text>

    <!-- Mini graph -->
    <rect x="20" y="45" width="160" height="100" fill="white" stroke="#ccc"/>
    <line x1="20" y1="145" x2="180" y2="145" class="axis"/>
    <line x1="20" y1="45" x2="20" y2="145" class="axis"/>

    <!-- Overshoot waveform -->
    <path d="M20,140 L30,140 L35,50 Q40,45 45,55 Q55,68 70,70 L180,70"
          fill="none" stroke="#cc0000" stroke-width="2"/>
    <!-- Ideal reference -->
    <path d="M20,140 L30,140 L35,70 L180,70"
          fill="none" stroke="#999" stroke-width="1" stroke-dasharray="3,2"/>

    <text x="100" y="160" text-anchor="middle" class="axis-label">Time (ns)</text>

    <!-- Characteristics -->
    <text x="195" y="60" class="legend">• Overshoot spike</text>
    <text x="195" y="75" class="legend">• Then settles</text>
    <text x="195" y="90" class="legend">• Ringing possible</text>
    <text x="195" y="115" class="legend" fill="#cc0000" style="font-weight:bold">→ Decrease C1</text>
  </g>

  <!-- MIDDLE: Frequency Response -->
  <g transform="translate(30,250)">
    <text x="215" y="0" text-anchor="middle" class="title">Frequency Response</text>
    <text x="215" y="15" text-anchor="middle" class="subtitle">(Orange region is what you can verify with 10 MHz generator)</text>

    <!-- Graph area -->
    <rect x="50" y="30" width="350" height="150" fill="white" stroke="#ccc"/>

    <!-- Verifiable region highlight -->
    <rect x="50" y="30" width="200" height="150" fill="#fff8e0" opacity="0.5"/>
    <text x="150" y="170" text-anchor="middle" class="legend" fill="#996600">Frequencies you</text>
    <text x="150" y="180" text-anchor="middle" class="legend" fill="#996600">can test</text>

    <!-- Grid (log scale) -->
    <g class="grid">
      <line x1="50" y1="60" x2="400" y2="60"/>
      <line x1="50" y1="90" x2="400" y2="90"/>
      <line x1="50" y1="120" x2="400" y2="120"/>
      <line x1="50" y1="150" x2="400" y2="150"/>
      <line x1="120" y1="30" x2="120" y2="180"/>
      <line x1="190" y1="30" x2="190" y2="180"/>
      <line x1="260" y1="30" x2="260" y2="180"/>
      <line x1="330" y1="30" x2="330" y2="180"/>
    </g>

    <!-- 0dB reference -->
    <line x1="50" y1="90" x2="400" y2="90" stroke="#999" stroke-width="1" stroke-dasharray="3,3"/>

    <!-- Axes -->
    <line x1="50" y1="180" x2="400" y2="180" class="axis"/>
    <line x1="50" y1="30" x2="50" y2="180" class="axis"/>

    <text x="225" y="200" text-anchor="middle" class="axis-label">Frequency (MHz)</text>
    <text x="20" y="105" text-anchor="middle" class="axis-label" transform="rotate(-90,20,105)">Relative Gain (dB)</text>

    <!-- Log scale labels -->
    <text x="50" y="215" text-anchor="middle" class="axis-label">0.01</text>
    <text x="120" y="215" text-anchor="middle" class="axis-label">0.1</text>
    <text x="190" y="215" text-anchor="middle" class="axis-label">1</text>
    <text x="260" y="215" text-anchor="middle" class="axis-label">10</text>
    <text x="330" y="215" text-anchor="middle" class="axis-label">100</text>
    <text x="400" y="215" text-anchor="middle" class="axis-label">1000</text>

    <text x="45" y="33" text-anchor="end" class="axis-label">+4</text>
    <text x="45" y="63" text-anchor="end" class="axis-label">+2</text>
    <text x="45" y="93" text-anchor="end" class="axis-label">0</text>
    <text x="45" y="123" text-anchor="end" class="axis-label">-2</text>
    <text x="45" y="153" text-anchor="end" class="axis-label">-4</text>
    <text x="45" y="183" text-anchor="end" class="axis-label">-6</text>

    <!-- Under-compensated (drops at high freq) -->
    <path d="M50,90 L190,90 Q230,95 260,110 Q300,140 350,165 L400,180"
          fill="none" stroke="#0066cc" stroke-width="2"/>

    <!-- Optimal (flat to 200MHz) -->
    <path d="M50,90 L330,90 Q360,95 380,105 Q395,115 400,130"
          fill="none" stroke="#00aa00" stroke-width="2"/>

    <!-- Over-compensated (rises then drops) -->
    <path d="M50,90 L190,88 Q230,80 260,70 Q290,65 310,70 Q350,90 380,120 Q395,140 400,160"
          fill="none" stroke="#cc0000" stroke-width="2"/>

    <!-- 10 MHz marker -->
    <line x1="260" y1="30" x2="260" y2="180" stroke="#ff9900" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="260" y="25" text-anchor="middle" class="legend" fill="#ff9900">Your max freq (10 MHz)</text>

    <!-- 200 MHz target -->
    <line x1="355" y1="30" x2="355" y2="180" stroke="#666" stroke-width="1" stroke-dasharray="2,2"/>
    <text x="355" y="25" text-anchor="middle" class="legend">Target (200 MHz)</text>

    <!-- Legend -->
    <rect x="255" y="125" width="140" height="50" fill="white" stroke="#ccc"/>
    <line x1="260" y1="138" x2="280" y2="138" stroke="#0066cc" stroke-width="2"/>
    <text x="285" y="141" class="legend">Under (C1&lt;1.0)</text>
    <line x1="260" y1="153" x2="280" y2="153" stroke="#00aa00" stroke-width="2"/>
    <text x="285" y="156" class="legend">Optimal (C1=1.24)</text>
    <line x1="260" y1="168" x2="280" y2="168" stroke="#cc0000" stroke-width="2"/>
    <text x="285" y="171" class="legend">Over (C1&gt;1.8)</text>
  </g>

  <!-- TEST SETUP DIAGRAM -->
  <g transform="translate(480,250)">
    <rect x="0" y="0" width="440" height="195" fill="white" stroke="#ccc" rx="5"/>
    <text x="220" y="20" text-anchor="middle" class="title">TEST SETUP</text>

    <!-- Function Generator -->
    <rect x="20" y="50" width="100" height="60" fill="#e0e0ff" stroke="#666" rx="3"/>
    <text x="70" y="75" text-anchor="middle" class="legend">Function Generator</text>
    <text x="70" y="90" text-anchor="middle" class="legend">1 MHz Square</text>
    <text x="70" y="102" text-anchor="middle" class="legend">~1Vp-p</text>

    <!-- Differential Probe -->
    <rect x="170" y="40" width="100" height="80" fill="#ffe0e0" stroke="#666" rx="3"/>
    <text x="220" y="65" text-anchor="middle" class="legend">Differential</text>
    <text x="220" y="80" text-anchor="middle" class="legend">Probe</text>
    <text x="220" y="100" text-anchor="middle" class="legend" fill="#cc0000">(DUT)</text>

    <!-- Oscilloscope -->
    <rect x="320" y="50" width="100" height="60" fill="#e0ffe0" stroke="#666" rx="3"/>
    <text x="370" y="75" text-anchor="middle" class="legend">Oscilloscope</text>
    <text x="370" y="90" text-anchor="middle" class="legend">1MΩ or 50Ω</text>

    <!-- Connections -->
    <line x1="120" y1="70" x2="170" y2="60" stroke="#333" stroke-width="2"/>
    <text x="145" y="55" class="legend">+</text>
    <line x1="120" y1="90" x2="170" y2="100" stroke="#333" stroke-width="2"/>
    <text x="145" y="110" class="legend">-</text>

    <line x1="270" y1="80" x2="320" y2="80" stroke="#333" stroke-width="2"/>
    <text x="295" y="75" class="legend">BNC Output</text>

    <!-- Ground connection -->
    <line x1="70" y1="110" x2="70" y2="140" stroke="#333" stroke-width="1"/>
    <line x1="70" y1="140" x2="220" y2="140" stroke="#333" stroke-width="1"/>
    <line x1="220" y1="120" x2="220" y2="140" stroke="#333" stroke-width="1"/>
    <text x="145" y="155" text-anchor="middle" class="legend">GND</text>

    <!-- Warning -->
    <text x="220" y="180" text-anchor="middle" class="warning">NOTE: Avoid probing the</text>
    <text x="220" y="192" text-anchor="middle" class="warning">internal test points with</text>
  </g>

  <!-- Continuation of warning and note about 15pF -->
  <g transform="translate(480,445)">
    <text x="220" y="0" text-anchor="middle" class="warning">15pF scope probe during</text>
    <text x="220" y="12" text-anchor="middle" class="warning">tuning - use BNC output!</text>
  </g>

  <!-- STEP-BY-STEP PROCEDURE -->
  <g transform="translate(30,480)">
    <rect x="0" y="0" width="890" height="300" fill="#f5f5ff" stroke="#0066cc" rx="5"/>
    <text x="445" y="20" text-anchor="middle" class="title" fill="#0066cc">STEP-BY-STEP TUNING PROCEDURE</text>

    <!-- Preparation -->
    <text x="15" y="45" class="step-title">PREPARATION</text>
    <text x="25" y="62" class="step">• Non-metallic adjustment tool (plastic or ceramic screwdriver)</text>
    <text x="25" y="77" class="step">• Function generator: 1 MHz square wave, 1 Vp-p, 50Ω output</text>
    <text x="25" y="92" class="step">• Connect probe: (+) input to signal, (-) input to generator ground</text>
    <text x="25" y="107" class="step">• Connect probe BNC output to scope via 50Ω terminator or BNC cable with 50Ω feedthrough</text>

    <!-- Step 1 -->
    <text x="15" y="132" class="step-title">STEP 1: COARSE ADJUSTMENT (1 MHz Square Wave)</text>
    <text x="25" y="149" class="step">1. Set C2 to middle position (~7 pF)</text>
    <text x="25" y="164" class="step">2. Set C1 to minimum (fully counter-clockwise)</text>
    <text x="25" y="179" class="step">3. Observe: Should see rounded corners (under-compensated)</text>
    <text x="25" y="194" class="step">4. Slowly increase C1 until corners become sharp</text>
    <text x="25" y="209" class="step">5. If overshoot appears, back off C1 slightly</text>
    <text x="25" y="224" class="step">6. Target: Sharp corners, flat top, NO overshoot</text>

    <!-- Step 2 -->
    <text x="470" y="45" class="step-title">STEP 2: FINE ADJUSTMENT (10 MHz Sine Wave)</text>
    <text x="480" y="62" class="step">1. Switch to 10 MHz sine wave</text>
    <text x="480" y="77" class="step">2. Measure amplitude at 10 MHz</text>
    <text x="480" y="92" class="step">3. Switch to 100 kHz sine wave (same amplitude setting)</text>
    <text x="480" y="107" class="step">4. Measure amplitude at 100 kHz</text>
    <text x="480" y="122" class="step">5. Adjust C1 until amplitudes match within 5%</text>
    <text x="480" y="137" class="step">6. Re-verify with square wave</text>

    <!-- Step 3 -->
    <text x="470" y="162" class="step-title">STEP 3: C2 BANDWIDTH OPTIMIZATION</text>
    <text x="480" y="179" class="step">1. If bandwidth seems limited, DECREASE C2 slightly</text>
    <text x="480" y="194" class="step">2. Re-adjust C1 to restore flat response</text>
    <text x="480" y="209" class="step">3. Relationship: C2 = 9 × C1 (for R1=9MΩ, R2=1MΩ)</text>
    <text x="480" y="224" class="step">4. Lower C2 = wider bandwidth but tighter C1 tolerance</text>

    <!-- Step 4 -->
    <text x="470" y="249" class="step-title">STEP 4: CHANNEL MATCHING (CMRR Optimization)</text>
    <text x="480" y="266" class="step">1. Apply same signal to both inputs (tie + and - together)</text>
    <text x="480" y="281" class="step">2. Output should be nearly zero (common-mode rejection)</text>
    <text x="480" y="296" class="step">3. Fine-tune C2 and C4 for minimum output (max CMRR)</text>
    <text x="480" y="311" class="step">4. Target: &lt;15mV output for 1V common-mode (60dB CMRR)</text>

    <!-- Expected Results - moved down -->
    <text x="15" y="340" class="step-title">EXPECTED RESULTS</text>
    <text x="25" y="357" class="step">• C1: ~1.3 pF (range: 1.0 - 1.6 pF)</text>
    <text x="25" y="372" class="step">• C2: ~7 pF (range: 5 - 10 pF) - affects bandwidth</text>
    <text x="250" y="357" class="step">• Square wave rise time: &lt; 5 ns</text>
    <text x="250" y="372" class="step">• Amplitude match 100kHz vs 10MHz: within 5% (0.4 dB)</text>
  </g>

  <!-- C1/C2 RELATIONSHIP BOX -->
  <g transform="translate(30,810)">
    <rect x="0" y="0" width="890" height="80" fill="#fff8e0" stroke="#cc9900" rx="5"/>
    <text x="445" y="18" text-anchor="middle" class="title" fill="#996600">UNDERSTANDING C1 AND C2 RELATIONSHIP</text>

    <text x="15" y="38" class="step" style="font-weight:bold">Compensation condition: R1 × C1 = R2 × C2</text>
    <text x="300" y="38" class="step">With R1=9MΩ, R2=1MΩ: C2 = 9 × C1</text>

    <text x="15" y="55" class="step">C1 (0.5-2pF): Primary tuning - adjusts the compensation zero to cancel the C2 pole</text>
    <text x="15" y="70" class="step">C2 (5-10pF): Sets bandwidth - larger C2 = lower bandwidth but easier compensation; smaller C2 = wider BW but C1 more critical</text>

    <text x="580" y="55" class="step" fill="#0066cc">C2 also used for CMRR optimization:</text>
    <text x="580" y="70" class="step" fill="#0066cc">Match C2/C4 to balance + and - channels</text>
  </g>
</svg>
